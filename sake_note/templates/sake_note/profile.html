{% extends 'sake_note/base.html' %}

{% block content %}
<div style="text-align: center; margin-bottom: 30px;">
    <h2>ğŸ‘¤ {{ target_user.username }} ã•ã‚“ã®æ—¥æœ¬é…’å‚¾å‘</h2>
    <p>è¨˜éŒ²æ•°: {{ sake_list.count }} ä»¶</p>
</div>

<div style="display: flex; flex-wrap: wrap; gap: 40px; justify-content: center;">
    
    <div style="flex: 1; min-width: 300px; max-width: 500px;">
        <canvas id="tasteRadarChart"></canvas>
    </div>

    <div style="flex: 1; min-width: 300px;">
        <h3>æœ€è¿‘ã®è¨˜éŒ²</h3>
        <ul>
            {% for sake in sake_list|slice:":5" %}
                <li>
                    <a href="{% url 'update' sake.id %}">{{ sake.title }}</a>
                    <span style="color: gold;">{{ sake.get_score_display }}</span>
                    <small>({{ sake.tasting_date }})</small>
                </li>
            {% empty %}
                <li>ã¾ã è¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“</li>
            {% endfor %}
        </ul>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    // Djangoã‹ã‚‰æ¸¡ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’JSã®å¤‰æ•°ã«å…¥ã‚Œã‚‹
    const radarData = {
        labels: ['ç”˜å‘³', 'é…¸å‘³', 'å¾Œå‘³', 'é¦™ã‚Š', 'æ—¨ã¿'],
        datasets: [{
            label: 'å¹³å‡çš„ãªå¥½ã¿',
            data: [
                {{ radar_data.sweetness }},
                {{ radar_data.acidity }},
                {{ radar_data.aftertaste }},
                {{ radar_data.aroma }},
                {{ radar_data.umami }}
            ],
            backgroundColor: 'rgba(54, 162, 235, 0.2)', // ã‚°ãƒ©ãƒ•ã®ä¸­ã®è‰²
            borderColor: 'rgba(54, 162, 235, 1)',     // ç·šã®è‰²
            borderWidth: 2
        }]
    };

    const config = {
        type: 'radar', // ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã‚’æŒ‡å®š
        data: radarData,
        options: {
            scales: {
                r: {
                    min: 0,
                    max: 5, // 5æ®µéšè©•ä¾¡ãªã®ã§MAX5
                    ticks: { stepSize: 1 },
                    pointLabels: {
                        font: { size: 14 }
                    }
                }
            }
        }
    };

    // ã‚°ãƒ©ãƒ•ã‚’æç”»
    new Chart(
        document.getElementById('tasteRadarChart'),
        config
    );
</script>

<div style="text-align: center; margin-top: 30px;">
    <a href="{% url 'index' %}" class="btn">ãƒˆãƒƒãƒ—ã«æˆ»ã‚‹</a>
</div>
{% endblock %}